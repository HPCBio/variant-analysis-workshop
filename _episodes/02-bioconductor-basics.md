---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 02-bioconductor-basics.md in _episodes_rmd/
source: Rmd
title: "Bioconductor basics"
teaching: 10
exercises: 2
questions:
- "What are the Bioconductor classes for the types of data we would find in a VCF?"
objectives:
- "Create a GRanges object to indicate regions of the genome that you are interested in."
- "Load DNA sequences from a reference genome."
- "Extract assay metadata from the results of an experiment."
- "Find help pages to learn more about what you can do with this data."
keypoints:
- "GRanges stores positions within a genome for any type of feature (SNP, exon, etc.)"
- "DNAStringSet stores DNA sequences."
- "FaFile creates a pointer to a reference genome file on your computer."
- "SummarizedExperiment stores the results of a set of assays across a set of samples."
---



Bioconductor packages are all designed to work together.  This is why, when you
tried installing three packages, it probably installed dozens of dependencies.
The benefit is that the same functions are useful across many different
bioinformatics workflows.  To explore those building blocks, we'll load a few of
those dependencies.


~~~
library(GenomicRanges)
library(Biostrings)
library(Rsamtools)
library(SummarizedExperiment)
~~~
{: .language-r}

## Reference genome

In the [setup](setup.md), you downloaded and unzipped a reference genome file.


~~~
ref_file <- "data/Zm-B73-REFERENCE-GRAMENE-4.0.fasta"
~~~
{: .language-r}

You should build an _index_ for the file.  This is another file, ending in
`.fai`, that indicates where in the file each chromosome starts.  It enables
quick access to specific regions of the genome.


~~~
indexFa(ref_file)
~~~
{: .language-r}

Now we can import the reference genome.


~~~
mygenome <- FaFile(ref_file)
~~~
{: .language-r}

If we try to print it out:


~~~
mygenome
~~~
{: .language-r}



~~~
class: FaFile 
path: data/Zm-B73-REFERENCE-GRAMENE-4.0.fasta
index: data/Zm-B73-REFERENCE-GRAMENE-4.0.fasta.fai
gzindex: data/Zm-B73-REFERENCE-GRAMENE-4.0.fasta.gzi
isOpen: FALSE 
yieldSize: NA 
~~~
{: .output}

Hmm, we don't see any DNA sequences, just names of files.  We haven't actually
loaded the data into R, just told R where to look when we want the data.  This
saves RAM since we don't usually need to analyze the whole genome at once.

We can get some information about the genome:


~~~
seqinfo(mygenome)
~~~
{: .language-r}



~~~
Seqinfo object with 266 sequences from an unspecified genome:
  seqnames      seqlengths isCircular genome
  Chr10          150982314       <NA>   <NA>
  Chr1           307041717       <NA>   <NA>
  Chr2           244442276       <NA>   <NA>
  Chr3           235667834       <NA>   <NA>
  Chr4           246994605       <NA>   <NA>
  ...                  ...        ...    ...
  B73V4_ctg253       82972       <NA>   <NA>
  B73V4_ctg254       69595       <NA>   <NA>
  B73V4_ctg255       46945       <NA>   <NA>
  B73V4_ctg2729     124116       <NA>   <NA>
  Pt                140447       <NA>   <NA>
~~~
{: .output}

There are chromosomes, and some smaller contigs.

> ## Challenge: Chromosome names
>
> Look at the help page for `seqinfo`.  Can you find a way to view all of the sequence names?
>
> > ## Solution
> > 
> > There is a `seqnames` function.  It doesn't work directly on a `FaFile`
> > object however.  It works on the `SeqInfo` object returned by `seqinfo`.
> >
> > 
> > ~~~
> > seqnames(seqinfo(mygenome))
> > ~~~
> > {: .language-r}
> > 
> > 
> > 
> > ~~~
> >   [1] "Chr10"         "Chr1"          "Chr2"          "Chr3"         
> >   [5] "Chr4"          "Chr5"          "Chr6"          "Chr7"         
> >   [9] "Chr8"          "Chr9"          "B73V4_ctg1"    "B73V4_ctg2"   
> >  [13] "B73V4_ctg3"    "B73V4_ctg4"    "B73V4_ctg5"    "B73V4_ctg6"   
> >  [17] "B73V4_ctg7"    "B73V4_ctg8"    "B73V4_ctg9"    "B73V4_ctg10"  
> >  [21] "B73V4_ctg11"   "B73V4_ctg12"   "B73V4_ctg13"   "B73V4_ctg14"  
> >  [25] "B73V4_ctg15"   "B73V4_ctg16"   "B73V4_ctg17"   "B73V4_ctg18"  
> >  [29] "B73V4_ctg19"   "B73V4_ctg20"   "B73V4_ctg21"   "B73V4_ctg22"  
> >  [33] "B73V4_ctg23"   "B73V4_ctg24"   "B73V4_ctg25"   "B73V4_ctg26"  
> >  [37] "B73V4_ctg27"   "B73V4_ctg28"   "B73V4_ctg29"   "B73V4_ctg30"  
> >  [41] "B73V4_ctg31"   "B73V4_ctg32"   "B73V4_ctg33"   "B73V4_ctg34"  
> >  [45] "B73V4_ctg35"   "B73V4_ctg36"   "B73V4_ctg37"   "B73V4_ctg38"  
> >  [49] "B73V4_ctg39"   "B73V4_ctg40"   "B73V4_ctg41"   "B73V4_ctg42"  
> >  [53] "B73V4_ctg43"   "B73V4_ctg44"   "B73V4_ctg45"   "B73V4_ctg46"  
> >  [57] "B73V4_ctg47"   "B73V4_ctg48"   "B73V4_ctg49"   "B73V4_ctg50"  
> >  [61] "B73V4_ctg51"   "B73V4_ctg52"   "B73V4_ctg53"   "B73V4_ctg54"  
> >  [65] "B73V4_ctg56"   "B73V4_ctg57"   "B73V4_ctg58"   "B73V4_ctg59"  
> >  [69] "B73V4_ctg60"   "B73V4_ctg61"   "B73V4_ctg62"   "B73V4_ctg63"  
> >  [73] "B73V4_ctg64"   "B73V4_ctg65"   "B73V4_ctg66"   "B73V4_ctg67"  
> >  [77] "B73V4_ctg68"   "B73V4_ctg69"   "B73V4_ctg70"   "B73V4_ctg71"  
> >  [81] "B73V4_ctg72"   "B73V4_ctg73"   "B73V4_ctg74"   "B73V4_ctg75"  
> >  [85] "B73V4_ctg76"   "B73V4_ctg77"   "B73V4_ctg78"   "B73V4_ctg79"  
> >  [89] "B73V4_ctg80"   "B73V4_ctg81"   "B73V4_ctg82"   "B73V4_ctg83"  
> >  [93] "B73V4_ctg84"   "B73V4_ctg85"   "B73V4_ctg86"   "B73V4_ctg87"  
> >  [97] "B73V4_ctg88"   "B73V4_ctg89"   "B73V4_ctg90"   "B73V4_ctg91"  
> > [101] "B73V4_ctg92"   "B73V4_ctg93"   "B73V4_ctg94"   "B73V4_ctg95"  
> > [105] "B73V4_ctg96"   "B73V4_ctg97"   "B73V4_ctg98"   "B73V4_ctg99"  
> > [109] "B73V4_ctg100"  "B73V4_ctg101"  "B73V4_ctg102"  "B73V4_ctg103" 
> > [113] "B73V4_ctg104"  "B73V4_ctg105"  "B73V4_ctg106"  "B73V4_ctg107" 
> > [117] "B73V4_ctg108"  "B73V4_ctg109"  "B73V4_ctg110"  "B73V4_ctg111" 
> > [121] "B73V4_ctg112"  "B73V4_ctg113"  "B73V4_ctg114"  "B73V4_ctg115" 
> > [125] "B73V4_ctg116"  "B73V4_ctg117"  "B73V4_ctg118"  "B73V4_ctg119" 
> > [129] "B73V4_ctg120"  "B73V4_ctg121"  "B73V4_ctg122"  "B73V4_ctg123" 
> > [133] "B73V4_ctg124"  "B73V4_ctg125"  "B73V4_ctg126"  "B73V4_ctg127" 
> > [137] "B73V4_ctg128"  "B73V4_ctg129"  "B73V4_ctg130"  "B73V4_ctg131" 
> > [141] "B73V4_ctg132"  "B73V4_ctg133"  "B73V4_ctg134"  "B73V4_ctg135" 
> > [145] "B73V4_ctg136"  "B73V4_ctg137"  "B73V4_ctg138"  "B73V4_ctg139" 
> > [149] "B73V4_ctg140"  "B73V4_ctg141"  "B73V4_ctg142"  "B73V4_ctg143" 
> > [153] "B73V4_ctg144"  "B73V4_ctg145"  "B73V4_ctg146"  "B73V4_ctg147" 
> > [157] "B73V4_ctg148"  "B73V4_ctg149"  "B73V4_ctg150"  "B73V4_ctg151" 
> > [161] "B73V4_ctg152"  "B73V4_ctg153"  "B73V4_ctg154"  "B73V4_ctg155" 
> > [165] "B73V4_ctg156"  "B73V4_ctg157"  "B73V4_ctg158"  "B73V4_ctg159" 
> > [169] "B73V4_ctg160"  "B73V4_ctg161"  "B73V4_ctg162"  "B73V4_ctg163" 
> > [173] "B73V4_ctg164"  "B73V4_ctg165"  "B73V4_ctg166"  "B73V4_ctg167" 
> > [177] "B73V4_ctg168"  "B73V4_ctg169"  "B73V4_ctg170"  "B73V4_ctg171" 
> > [181] "B73V4_ctg172"  "B73V4_ctg173"  "B73V4_ctg174"  "B73V4_ctg175" 
> > [185] "B73V4_ctg176"  "B73V4_ctg177"  "B73V4_ctg178"  "B73V4_ctg179" 
> > [189] "B73V4_ctg180"  "B73V4_ctg181"  "B73V4_ctg182"  "B73V4_ctg183" 
> > [193] "B73V4_ctg184"  "B73V4_ctg185"  "B73V4_ctg186"  "B73V4_ctg187" 
> > [197] "B73V4_ctg188"  "B73V4_ctg189"  "B73V4_ctg190"  "B73V4_ctg191" 
> > [201] "B73V4_ctg192"  "B73V4_ctg193"  "B73V4_ctg194"  "B73V4_ctg195" 
> > [205] "B73V4_ctg196"  "B73V4_ctg197"  "B73V4_ctg198"  "B73V4_ctg199" 
> > [209] "B73V4_ctg200"  "B73V4_ctg201"  "B73V4_ctg202"  "B73V4_ctg203" 
> > [213] "B73V4_ctg204"  "B73V4_ctg205"  "B73V4_ctg206"  "B73V4_ctg207" 
> > [217] "B73V4_ctg208"  "B73V4_ctg209"  "B73V4_ctg210"  "B73V4_ctg211" 
> > [221] "B73V4_ctg212"  "B73V4_ctg213"  "B73V4_ctg214"  "B73V4_ctg215" 
> > [225] "B73V4_ctg216"  "B73V4_ctg217"  "B73V4_ctg218"  "B73V4_ctg219" 
> > [229] "B73V4_ctg220"  "B73V4_ctg221"  "B73V4_ctg222"  "B73V4_ctg223" 
> > [233] "B73V4_ctg224"  "B73V4_ctg225"  "B73V4_ctg226"  "B73V4_ctg227" 
> > [237] "B73V4_ctg228"  "B73V4_ctg229"  "B73V4_ctg230"  "B73V4_ctg231" 
> > [241] "B73V4_ctg232"  "B73V4_ctg233"  "B73V4_ctg234"  "B73V4_ctg235" 
> > [245] "B73V4_ctg236"  "B73V4_ctg237"  "B73V4_ctg238"  "B73V4_ctg239" 
> > [249] "B73V4_ctg240"  "B73V4_ctg241"  "B73V4_ctg242"  "B73V4_ctg243" 
> > [253] "B73V4_ctg244"  "B73V4_ctg245"  "B73V4_ctg246"  "B73V4_ctg247" 
> > [257] "B73V4_ctg248"  "B73V4_ctg249"  "B73V4_ctg250"  "B73V4_ctg251" 
> > [261] "B73V4_ctg252"  "B73V4_ctg253"  "B73V4_ctg254"  "B73V4_ctg255" 
> > [265] "B73V4_ctg2729" "Pt"           
> > ~~~
> > {: .output}
> {: .solution}
{: .challenge}

{% include links.md %}
